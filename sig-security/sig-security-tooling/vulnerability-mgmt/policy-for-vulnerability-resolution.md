# Policy for Vulnerability resolution

Depending on the impact of the vulnerability identified, appropriate resolution
is triggered to apply the fix to Kubernetes or document the cause for not fixing

## Assumptions

1. All vulnerabilities that are publicly identified (e.g. with a CVE Identifier)
   are triaged in public
2. For undisclosed or non-public vulnerabilities, the
   [responsible disclosure process](https://kubernetes.io/docs/reference/issues-security/security/)
   is followed

## Triage process

- The vulnerabilities are triaged in private, by members of
  `security-tooling-private@kubernetes.io`
- Membership to this group is restricted due to the confidential nature of the
  responsibilities
- Once a vulnerability is found through automation, the group members get
  notified via an email about it
- One of the group members then triages this vulnerability and classifies it
  into one of the following categories:

  |No.   |  Category |  Definition |  Resolution |
     |---|---|---|---|
  | 1  | False positive  |  k/k and vulnerable package is not impacted by this CVE | Open a Github issue and log the resolution  |
  | 2  | True positive but no impact  | Package version used in k/k is vulnerable, but k/k is not using the vulnerable code  | Open a Github issue and a PR to bump the dependency to the version with a fix. This fix will go in subsequent release of k/k  |
  | 3  | True positive with negligible impact  | Package version used in k/k is vulnerable, but k/k is using the vulnerable code, but the vulnerability does not apply as per k/k threat model  |  Open a Github issue that describes why this will have negligible impact with relevant compensatory controls. Also, open a PR to bump the dependency to the version with a fix. This fix will go in subsequent release of k/k |
  | 4  | True positive with impact  | Package version used in k/k is vulnerable, and k/k is using the vulnerable code  |  Open a Github issue, that assesses impact, modifies CVSS rating for k8s, if needed and suggest compensatory controls. Also, open a PR to bump the dependency and backport the fix up to n-2 k/k version |
  | 5  | Embargoed vulnerability  | No CVE ID is assigned so scanners do not detect it  |  Product Security Committee / Security Response Committee triages and follows existing process for embargoed CVEs |

- Once the category is identified, the resolution is triggered manually by the
  member triaging the vulnerability.

## Examples

- [CVE-2020-26160](https://github.com/kubernetes/kubernetes/issues/100401)
- [CVE-2021-20206](https://github.com/kubernetes/kubernetes/issues/101758)

## Next Steps

1. Create ignore lists for category 1, 2 and 3. Build a process to evaluate
   ignore lists for category 2 and 3 periodically.
2. Formalize or
   modify [this](https://github.com/kubernetes/security/blob/master/security-release-process.md#severity-thresholds---how-we-do-vulnerability-scoring)
   process from Product Security Committee / Security Response Committee, when
   the modifying original CVSS score makes sense